# 长文本输出测试场景

## 测试目的

验证 TUI 在处理长文本输出时的：
- ✅ 流式输出性能
- ✅ 滚动功能
- ✅ 消息显示
- ✅ 内存使用

---

## 测试场景

### 场景 1: 生成长代码（推荐）

```
请用 Go 写一个完整的快速排序算法实现，包括：
1. 主函数 QuickSort
2. 分区函数 Partition
3. 单元测试
4. 详细注释
```

**预期输出**: ~100-200 行代码

---

### 场景 2: 读取长文件

```
读取并详细解释 cmd/kore/main.go 文件的完整内容
```

**预期输出**: 完整文件内容 + 解释

---

### 场景 3: 架构解释

```
请详细解释 Kore 项目的架构设计，包括：
1. 整体架构模式
2. 各个模块的职责
3. 数据流向
4. 设计模式应用
5. 扩展机制
```

**预期输出**: ~500-800 字的详细说明

---

### 场景 4: 生成教程

```
请写一个 Go 语言并发编程的完整教程，包括：
1. Goroutine 的使用
2. Channel 的使用
3. Select 语句
4. Sync 包
5. 最佳实践
6. 示例代码
```

**预期输出**: 超长教程（1000+ 字）

---

## 观察要点

### 流式输出
- [ ] 文本是否流畅显示（不卡顿）
- [ ] 状态栏是否显示 "生成回复..."
- [ ] Spinner 动画是否流畅

### 滚动功能
- [ ] Ctrl+↑ 是否能向上滚动
- [ ] Ctrl+↓ 是否能向下滚动
- [ ] 滚动是否平滑
- [ ] 是否能滚动到任意位置

### 消息显示
- [ ] 长文本是否正确显示
- [ ] 是否有过多的换行（已修复）
- [ ] 代码是否有语法高亮

### 性能
- [ ] CPU 使用是否正常
- [ ] 内存是否泄漏
- [ ] 输出完成后是否恢复

---

## 快速测试命令

### 方法 1: 直接测试（推荐）

```bash
.\bin\kore.exe chat --ui tui

# 然后输入：
请写一个完整的 Go HTTP 服务器，包括：
1. 路由处理
2. 中间件
3. JSON 响应
4. 错误处理
5. 详细注释
```

### 方法 2: 读取项目文件

```bash
.\bin\kore.exe chat --ui tui

# 输入：
读取并完整解释 docs/ARCHITECTURE.md 的内容
```

---

## 预期结果

### 成功标准

✅ 流式输出流畅，无卡顿
✅ 滚动功能正常工作
✅ 长文本完整显示
✅ 代码有语法高亮
✅ 完成后显示 "✓ 完成"（绿色）
✅ 2 秒后恢复为 "○ 准备就绪"
✅ 可以选择和复制长文本

### 性能指标

- **流式输出**: ~60fps
- **内存增长**: <50MB
- **CPU 使用**: <30%
- **响应时间**: <100ms

---

## 已知限制

1. **超长消息** (>10000 字)
   - Viewport 可能有性能问题
   - 建议分批处理

2. **快速滚动**
   - 在输出完成前滚动可能有延迟
   - 建议等输出完成后再滚动

3. **内存使用**
   - 长时间使用可能占用较多内存
   - 建议定期重启 TUI

---

## 测试报告模板

### 测试场景
- [ ] 场景 1: 生成长代码
- [ ] 场景 2: 读取长文件
- [ ] 场景 3: 架构解释
- [ ] 场景 4: 生成教程

### 性能观察
- 输出长度: ______ 字
- 输出耗时: ______ 秒
- 流式性能: ⬜ 流畅 / ⬜ 一般 / ⬜ 卡顿
- 滚动性能: ⬜ 流畅 / ⬜ 一般 / ⬜ 卡顿

### 问题记录
- 问题 1: _____________
- 问题 2: _____________

---

**准备好测试了吗？**

运行: `.\bin\kore.exe chat --ui tui`

然后复制粘贴任意场景的提示词！
